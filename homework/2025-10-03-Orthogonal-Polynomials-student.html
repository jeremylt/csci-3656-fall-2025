<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2025-10-03 Orthogonal Polynomials</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="2025-09-19 Rootfinding" href="2025-09-19-Rootfinding-student.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>Before you turn this problem in, make sure everything runs as expected. First, restart the kernel (in the menubar, select Kernel → Restart) and then run all cells (in the menubar, select Cell → Run All).</p>
<p>Make sure you fill in any place that says <code class="docutils literal notranslate"><span class="pre">BEGIN</span> <span class="pre">SOLUTION</span></code> and <code class="docutils literal notranslate"><span class="pre">END</span> <span class="pre">SOLUTION</span></code>, as well as your name and collaborators below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">COLLABORATORS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</pre></div>
</div>
</div>
<section id="2025-10-03-Orthogonal-Polynomials">
<h1>2025-10-03 Orthogonal Polynomials<a class="headerlink" href="#2025-10-03-Orthogonal-Polynomials" title="Link to this heading">¶</a></h1>
<p>In this activity, we will construct polynomials using orthogonality with respect to an integral inner product. For example, given functions <span class="math notranslate nohighlight">\(u \left( x \right)\)</span> and <span class="math notranslate nohighlight">\(v \left( x \right)\)</span>, we define their inner product to be</p>
<div class="math notranslate nohighlight">
\[\left\langle u, w \right\rangle = \int_{-1}{1} u \left( x \right) v \left( x \right) dx\]</div>
<p>where we use the notation <span class="math notranslate nohighlight">\(\left\langle u, w \right\rangle\)</span> to distinguish this continuous inner product from the discrete inner product <span class="math notranslate nohighlight">\(u^T v\)</span> of vectors.</p>
<p>This is known as the <span class="math notranslate nohighlight">\(L^2\)</span> inner product on the domain <span class="math notranslate nohighlight">\(\left( -1, 1 \right)\)</span>, which is a Hilbert space and a <cite>:math:`L^p</cite> space &lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Lp_space">https://en.wikipedia.org/wiki/Lp_space</a>&gt;`__. The study of such generalizations of linear algebraic concepts is called Functional Analysis, and advanced mathematical topic that is used in numerical activity. We will only need the above definition in this activity.</p>
<p>The inner product induces a norm,</p>
<div class="math notranslate nohighlight">
\[\left\lvert \left\lvert u \right\rvert \right\rvert = \sqrt{\left\langle u, u \right\rangle}\]</div>
<p>The inner product and norm satisfy the unual properties from our Linear Algebra notebook.</p>
<section id="Working-with-polynomials">
<h2>Working with polynomials<a class="headerlink" href="#Working-with-polynomials" title="Link to this heading">¶</a></h2>
<p>We’ll develop functions to evaluate, multiply, and integrate polynomials expressed as vectors of coefficients.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/latex&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\$</span><span class="s">x^2</span><span class="se">\$</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">Plots</span>
<span class="k">using</span><span class="w"> </span><span class="n">Test</span>

<span class="k">function</span><span class="w"> </span><span class="n">polystring</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Construct a string representation of the polynomial.</span>

<span class="s">    You don&#39;t need to understand this function, it is only</span>
<span class="s">    used to annotate plots and clearly view polynomials.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">join</span><span class="p">((</span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;x^</span><span class="si">$</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$a</span><span class="s"> x^</span><span class="si">$</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="s">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">≠</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="s">&quot; + &quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">polystring</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polydisp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Display the polynomial with friendly math formatting.&quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">join</span><span class="p">((</span><span class="sc">&#39;$&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$name</span><span class="s">(x) = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">polystring</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="sc">&#39;$&#39;</span><span class="p">))</span>
<span class="w">    </span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/latex&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Evaluate function described by coefficients p at point x.</span>

<span class="s">    This uses Horner&#39;s rule, which evaluates a0 + a1 x + a2 x^2 + a3 x^3 as</span>
<span class="s">    a0 + x * (a1 + x * (a2 + x * (a3))).</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="k">end</span><span class="p">]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="w">        </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">.+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">f</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">f</span>
<span class="k">end</span>

<span class="nd">@test</span><span class="w"> </span><span class="n">polyval</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="nb">π</span><span class="p">)</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="nb">π</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="nb">π</span><span class="o">^</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Plot a polynomial p(x) defined by its coefficients</span>
<span class="s">      p[1] + p[2]*x^1 + ... + p[n]*x^(n-1)</span>
<span class="s">    where n = length(p).  We evaluate the polynomial using</span>
<span class="s">    our polyval.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isnothing</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="w">        </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polystring</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">plot!</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">join</span><span class="p">((</span><span class="sc">&#39;$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;$&#39;</span><span class="p">)))</span>
<span class="k">end</span>

<span class="n">plot</span><span class="p">()</span>
<span class="n">polyplot</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The polynomial manipulation functions such as <code class="docutils literal notranslate"><span class="pre">polyint</span></code> are <span class="math notranslate nohighlight">\(\mathcal{O} \left( n \right)\)</span> (linear time) opeartions on lists or arrays. We’ll start by implementing <code class="docutils literal notranslate"><span class="pre">polyint</span></code>, which computes the indefinite integral</p>
<div class="math notranslate nohighlight">
\[P \left( x \right) = \int p \left( x \right) dx\]</div>
<p>i.e., <span class="math notranslate nohighlight">\(P' \left( x \right) = p \left( x \right)\)</span>. Note that the antiderivative <span class="math notranslate nohighlight">\(P \left( x \right)\)</span> is a polynomial determined only up to an integration constant, which you man choose arbitrarily.</p>
<p>As an example,</p>
<div class="math notranslate nohighlight">
\[\int 1 + 4 x + 6 x^3 = C + x + 2x^2 + \frac{6}{4} x^4\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> can be any value, so we should have</p>
<p><code class="docutils literal notranslate"><span class="pre">polyint([1</span> <span class="pre">4</span> <span class="pre">0</span> <span class="pre">6])</span> <span class="pre">==</span> <span class="pre">[0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">0</span> <span class="pre">6/4]</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyint</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Without using library functions, compute an indefinite integral</span>
<span class="s">    of p(x) expressed as a polynomial of degree 1 higher than the</span>
<span class="s">    degree of p.  The constant of integration may be chosen arbitrarily.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span><span class="w"> </span><span class="c"># Convert from row or column vector into list</span>
<span class="w">    </span><span class="n">pint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c"># Array to hold the indefinite integral</span>
<span class="w">    </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">    </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="c"># return a row vector (for easier viewing)</span>
<span class="w">    </span><span class="n">reshape</span><span class="p">(</span><span class="n">pint</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span>
<span class="n">polydisp</span><span class="p">(</span><span class="sc">&#39;p&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polyint</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">polydisp</span><span class="p">(</span><span class="sc">&#39;P&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span><span class="w"> </span><span class="n">polyint</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mf">.5</span><span class="p">]</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">polyint</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">polyint</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="Multiplying-polynomials">
<h2>Multiplying polynomials<a class="headerlink" href="#Multiplying-polynomials" title="Link to this heading">¶</a></h2>
<p>We need to be able to compute the product of polynomials. For example,</p>
<div class="math notranslate nohighlight">
\[\left( a_1 + a_2 x + a_3 x^2 \right) \left( b_1 + b_2 x + b_3 x^2 \right) = a_1 b_1 + \left( a_1 b_2 + a_2 b_1 \right) x + \left( a_1 b_3 + a_2 b_2 + a_3 b_1 \right) x^2 + \left( a_2 b_3 + a_3 b_2 \right) x^3 + a_3 b_3 x^4\]</div>
<p>(You may notice that one-based indexing is kinda awkward here compared to zero-based indexing.)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polymul</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Multiply two polynomials, returinng a polynomial.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="w">            </span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="c"># return a row vector (for easier viewing)</span>
<span class="w">    </span><span class="n">reshape</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polymul</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">])</span>
<span class="n">polydisp</span><span class="p">(</span><span class="sc">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">()</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">.5</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="n">polyplot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">polyplot</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">polyplot</span><span class="p">(</span><span class="n">polymul</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">))</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="ss">:black</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Addition-and-subtraction">
<h2>Addition and subtraction<a class="headerlink" href="#Addition-and-subtraction" title="Link to this heading">¶</a></h2>
<p>We need to be able to add and subtract polynomials, that is, to compute <span class="math notranslate nohighlight">\(r = p + q\)</span> and <span class="math notranslate nohighlight">\(r = p - q\)</span>. This is just entry-wise addition and subtraction, except that the vectors may have different lengths.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyadd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">q</span>
<span class="w">    </span><span class="n">reshape</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">polyadd</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polysub</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">q</span>
<span class="w">    </span><span class="n">reshape</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">polysub</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="Inner-products-of-polynomials">
<h2>Inner products of polynomials<a class="headerlink" href="#Inner-products-of-polynomials" title="Link to this heading">¶</a></h2>
<p>We will use the <span class="math notranslate nohighlight">\(L^2\)</span> inner product,</p>
<div class="math notranslate nohighlight">
\[\left\langle u, v \right\rangle = \int_{-1}^{1} u \left( x \right) v \left( x \right) dx\]</div>
<p>restricted to the case where <span class="math notranslate nohighlight">\(u \left( x \right)\)</span> and $ v <span class="math">\left`( x :nbsphinx-math:</span>right`)$ are polynomials.</p>
<p>Recall the <a class="reference external" href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_calculus">Fundamental Theorem of Calculus</a>, which says that</p>
<div class="math notranslate nohighlight">
\[\int_a^b f \left( x \right) = F \left( b \right) - F \left( a \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is a function such that <span class="math notranslate nohighlight">\(F' \left( x \right) = f \left( x \right)\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Use polymul, polyint, and polyval to define the L2</span>
<span class="s">    inner product of u and v on the interval (-1, 1). Both u and v</span>
<span class="s">    are polynomials expressed as arrays in the usual way. Recall that</span>
<span class="s">    the inner product returns a scalar (single number).</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">    </span><span class="c">### SOLUTION END</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">display_inner_product</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">    </span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/html&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\$</span><span class="s"> </span><span class="se">\\</span><span class="s">langle </span><span class="si">$</span><span class="p">(</span><span class="n">polystring</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="s">, </span><span class="si">$</span><span class="p">(</span><span class="n">polystring</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="s"> </span><span class="se">\\</span><span class="s">rangle = </span><span class="si">$</span><span class="p">(</span><span class="n">poly_inner_product</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">))</span><span class="s"> </span><span class="se">\$</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">poly_inner_product</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span>
<span class="n">display_inner_product</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span>
<span class="n">display_inner_product</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mi">0</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mi">0</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mi">0</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mf">11.2</span>
</pre></div>
</div>
</div>
</section>
<section id="Norms-of-polynomials">
<h2>Norms of polynomials<a class="headerlink" href="#Norms-of-polynomials" title="Link to this heading">¶</a></h2>
<p>Recall that an inner product <strong>induces</strong> a norm. We’ll define it now and use it later to normalize polynomials.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute the norm of the polynomial p(x) induced by poly_inner_product().</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">    </span><span class="c">### SOLUTION END</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Orthogonalization-of-polynomials">
<h2>Orthogonalization of polynomials<a class="headerlink" href="#Orthogonalization-of-polynomials" title="Link to this heading">¶</a></h2>
<p>We now have the ingredients to use the Gram-Schmidt algorithm to orgthogonalize polynomials (starting with the monomials) with respect to the <span class="math notranslate nohighlight">\(L^2\)</span> inner product. We start by defining a “matrix” in which each of the columns is a polynomial. This is conceptually similar to a Vandermonde matrix (see <code class="docutils literal notranslate"><span class="pre">np.vander()</span></code>) in the limit where we evaluate at infinitely many points; instead of storing infinitely tall columns, we store each as a list defining the polynomial.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Return a list of the first n monomials in order of increasing degree.</span>
<span class="s">    We will think of this as a &quot;tall&quot; matrix indexed by its n columns.</span>
<span class="s">    Each column contains a polynomial.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">        </span><span class="n">p</span><span class="p">[</span><span class="k">end</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">push!</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">A</span>
<span class="k">end</span>

<span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Columns of the monomial matrix&quot;</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="w">    </span><span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;p_</span><span class="si">$j</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">plot!</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Projections">
<h2>Projections<a class="headerlink" href="#Projections" title="Link to this heading">¶</a></h2>
<p>Polynomials can be projected just like vectors. For example, if <span class="math notranslate nohighlight">\(q \left( x \right)\)</span> is normalized,</p>
<div class="math notranslate nohighlight">
\[q \left\langle q, p \right\rangle\]</div>
<p>is the orthogonal projection of <span class="math notranslate nohighlight">\(p\)</span> into the subspace of <span class="math notranslate nohighlight">\(q\)</span> and</p>
<div class="math notranslate nohighlight">
\[p - q \left\langle q, p \right\rangle\]</div>
<p>is the part orthoronal to <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>Notice the similarities between the expressions above (involving the <span class="math notranslate nohighlight">\(L^2\)</span> inner product) and those for projections of finite-dimensional vectors, <span class="math notranslate nohighlight">\(q q^T p\)</span> and <span class="math notranslate nohighlight">\(\left( I - q q^T \right) p\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_project_orthog</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Find the component of p(x) that is orthogonal to the normalized</span>
<span class="s">    polynomial q(x).</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="c"># length of p in direction q</span>
<span class="w">    </span><span class="c"># polysub is just subtraction of arrays, but lines them up correctly</span>
<span class="w">    </span><span class="c"># in case they are different lengths</span>
<span class="w">    </span><span class="n">polysub</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="c"># p - q c</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">test_project</span><span class="p">()</span>
<span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot</span><span class="p">()</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w">                      </span><span class="c"># x</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w">                      </span><span class="c"># x^3</span>
<span class="w">    </span><span class="n">display_inner_product</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="w">    </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w">         </span><span class="c"># Normalize x in L^2 norm</span>
<span class="w">    </span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/latex&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\$</span><span class="s"> </span><span class="se">\\</span><span class="s">lVert p_1 </span><span class="se">\\</span><span class="s">rVert = </span><span class="si">$</span><span class="p">(</span><span class="n">poly_norm</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span><span class="s"> </span><span class="se">\$</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="w">    </span><span class="n">p3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_project_orthog</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">p1</span><span class="p">)</span><span class="w">  </span><span class="c"># Find component of x^3 that is orthogonal to x</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>
<span class="w">    </span><span class="n">display_inner_product</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">p3</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">test_project</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Polynomial-matrix-multiplication">
<h2>Polynomial matrix multiplication<a class="headerlink" href="#Polynomial-matrix-multiplication" title="Link to this heading">¶</a></h2>
<p>We have discussed the matrix product <span class="math notranslate nohighlight">\(A x\)</span> being a linear combination of the columns of <span class="math notranslate nohighlight">\(A\)</span>. If <span class="math notranslate nohighlight">\(A\)</span> is a polynomial matrix with <span class="math notranslate nohighlight">\(m\)</span> columns (we’ll say it has shape <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">m)</span></code>), then</p>
<div class="math notranslate nohighlight">
\[A x = \sum_i A_{:, i} x_i\]</div>
<p>Similarly, if <span class="math notranslate nohighlight">\(B\)</span> is a <span class="math notranslate nohighlight">\(m \times n\)</span> matrix (i.e. shape <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n)</span></code>), then the <span class="math notranslate nohighlight">\(j\)</span>th column of <span class="math notranslate nohighlight">\(C = A B\)</span> is</p>
<div class="math notranslate nohighlight">
\[C_{:, j} = \sum_k A_{:, k} B_{k, j}\]</div>
<p>The matrix <span class="math notranslate nohighlight">\(C\)</span> is also a polynomial matrix, now with shape <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n)</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">&#39;</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="n">Cref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">7</span><span class="p">]]</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">Cref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">Cref</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Multiply a polynomial matrix A of shape (*,m) times</span>
<span class="s">    a matrix B of shape (m,n) to yield a polynomial matrix</span>
<span class="s">    C of shape (*,n).</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="c"># Use polyadd to compute A * B[:,j] and</span>
<span class="w">        </span><span class="c"># append it to C using push!(C, new_col)</span>
<span class="w">        </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">        </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">C</span>
<span class="k">end</span>

<span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span>

<span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;C_{:,1}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;C_{:,2}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;C_{:,3}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">  </span><span class="c"># The polynomial 1</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w">  </span><span class="c"># The polynomial x</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w"> </span><span class="c"># The polynomial x^2</span>
</pre></div>
</div>
</div>
</section>
<section id="QR-factorization-of-monomials">
<h2>QR factorization of monomials<a class="headerlink" href="#QR-factorization-of-monomials" title="Link to this heading">¶</a></h2>
<p>We can apply the Gram-Schmidt process to compute a QR factorization of the monomials. This will yield an orthogonal basis of polynomials.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute a reduced QR factorization of the polynomials in the columns of A</span>
<span class="s">    using the Gram-Schmidt algorithm. If A has shape (*,n), the factor Q will have</span>
<span class="s">    shape (*,n) (i.e., a list of polynomials) and R will be a square (n,n)</span>
<span class="s">    triangular matrix.</span>

<span class="s">    This algorithm can look line-for-line like the naive Gram-Schmidt in our class</span>
<span class="s">    notebook (see Feb 11 or Feb 16 lectures), but you&#39;ll need to use the appropriate</span>
<span class="s">    functions that act on polynomials, an ensure you are accessing columns. That is,</span>
<span class="s">    when working with polynomial matrices (shape (*,n)), column j is accessed as A[j]</span>
<span class="s">    instead of A[:,j] for traditional matrices.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="w"> </span><span class="c"># Each column of A and R</span>
<span class="w">        </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">        </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span>
<span class="k">end</span>

<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="w">    </span><span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;q_{</span><span class="si">$j</span><span class="s">}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">## This cell explores some properties of the factorization, and its output</span>
<span class="c">## may be helpful in debugging your implementation above.</span>

<span class="k">function</span><span class="w"> </span><span class="n">poly_QtQ</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute Q.T Q where Q is a matrix of polynomials</span>
<span class="s">    expressed as a list of columns. The result is an ordinary</span>
<span class="s">    square matrix.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">            </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">A</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">poly_matsub</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute A - B where A and B are matrices of polynomials</span>
<span class="s">    expressed as lists of columns.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">        </span><span class="n">push!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">polysub</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">C</span>
<span class="k">end</span>

<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">QtQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_QtQ</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">QtQ</span>
<span class="n">QR_minus_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_matsub</span><span class="p">(</span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">QR_minus_A</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QtQ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QR_minus_A</span><span class="p">)</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QtQ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e-12</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QR_minus_A</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e-12</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># The Q factor loses orthogonality as the maximum degree is increased.</span>
<span class="c"># This is much the same effect as we&#39;ve observed with Vandermonde matrices</span>
<span class="c"># in class, and part of the motivation for the Householder algorithm.</span>

<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">QtQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_QtQ</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="n">QR_minus_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_matsub</span><span class="p">(</span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QtQ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QR_minus_A</span><span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="Plot-the-orthogonal-polynomials">
<h2>Plot the orthogonal polynomials<a class="headerlink" href="#Plot-the-orthogonal-polynomials" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_plotmat</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot</span><span class="p">()</span><span class="w"> </span><span class="c"># Create new figure</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">        </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;p_{</span><span class="si">$j</span><span class="s">}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">handle</span>
<span class="k">end</span>

<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">poly_plotmat</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Normalization">
<h2>Normalization<a class="headerlink" href="#Normalization" title="Link to this heading">¶</a></h2>
<p>Our QR factorization is normalied using the <span class="math notranslate nohighlight">\(L^2\)</span> norm, which is just fine mathematically, but perhaps not visually satisfying.</p>
<p>This set of polynomials is famous (<a class="reference external" href="https://en.wikipedia.org/wiki/Legendre_polynomials">Legendre polynomials</a>), but with the normalization <span class="math notranslate nohighlight">\(p \left( 1 \right) = 1\)</span> instead of the <span class="math notranslate nohighlight">\(L^2\)</span> normalization <span class="math notranslate nohighlight">\(\left\langle p \left( x \right), p \left( x \right) \right\rangle = 1\)</span>. Let’s convert our <span class="math notranslate nohighlight">\(QR\)</span> factorization to use this different normalization convention.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_qr_norm1</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute a QR factorization with the normalization convention that</span>
<span class="s">    q(1) = 1 for each column of Q.  This can be constructed by modifying</span>
<span class="s">    the standard QR factorization (scaling the columns of Q and absorbing</span>
<span class="s">    that scaling factor into R).</span>

<span class="s">    The resulting matrix Q should have columns that are orthogonal with</span>
<span class="s">    respect to the L^2 inner product, but they will not be normalized with</span>
<span class="s">    respect to that product.  Consequently, Q^T Q will be diagonal, but</span>
<span class="s">    not the identity.</span>

<span class="s">    The factors should still satisfy Q R = A.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="w">    </span><span class="c"># Loop over columns of Q (and rows of R).</span>
<span class="w">    </span><span class="c"># Use polyval() to evaluate each column at x=1 and use that</span>
<span class="w">    </span><span class="c"># normalization to scale the column of Q and corresponding entries</span>
<span class="w">    </span><span class="c"># of R. The new columns of Q should be orthogonal, but will not, in</span>
<span class="w">    </span><span class="c"># general, have norm 1.  This means Q^T Q will be diagonal, but not</span>
<span class="w">    </span><span class="c"># the identity.  Q R = A should still be satisfied.</span>
<span class="w">    </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">    </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span>
<span class="k">end</span>

<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr_norm1</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">poly_plotmat</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr_norm1</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">diag</span><span class="p">(</span><span class="n">poly_QtQ</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># There is an analytic formula for this normalizing factor</span>
<span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">5</span><span class="p">]</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
</section>
<section id="Recurrence-relation">
<h2>Recurrence relation<a class="headerlink" href="#Recurrence-relation" title="Link to this heading">¶</a></h2>
<p>Although there is also structure in the factor <span class="math notranslate nohighlight">\(R\)</span>, we are often interested only in the basis <span class="math notranslate nohighlight">\(Q\)</span>. Let us test whether our functions, the columns of <span class="math notranslate nohighlight">\(Q\)</span> (with our new normalization convention), satisfy the recurrence relation</p>
<div class="math notranslate nohighlight">
\[\left( n + 1 \right) q_{n + 1} \left( x \right) = \left( 2 n + 1 \right) x q_n \left( x \right) - n q_{n - 1} \left( x \right)\]</div>
<p>The above uses the standard convention that <span class="math notranslate nohighlight">\(q_n\)</span> is a polynomial of degree <span class="math notranslate nohighlight">\(n\)</span>, but we’re using Julia’s 1-based indexing so our <span class="math notranslate nohighlight">\(q_n\)</span> is a polynomial of degree <span class="math notranslate nohighlight">\(n - 1\)</span>. As such, we’ll rewrite the standard recurrrance as</p>
<div class="math notranslate nohighlight">
\[\left( n + 1 \right) q_{n + 2} \left( x \right) = \left( 2 n + 1 \right) x q_{n + 1} \left( x \right) - n q_n \left( x \right)\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>
<span class="w">    </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">polymul</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">Q</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="w">    </span><span class="n">rhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polysub</span><span class="p">(</span><span class="n">term</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
<span class="w">    </span><span class="n">lhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
<span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">(</span><span class="n">polysub</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="p">))</span>
<span class="w">    </span><span class="nd">@show</span><span class="w"> </span><span class="n">err</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<p>This recurrence is faster and more stable to evaluate than applying Gram-Schmidt to the monomials. We can use it to create a generalied Vandermonde matrix in which the columns are Legendre polynomials instead of the monomials. This matrix will look like</p>
<div class="math notranslate nohighlight">
\[Q = \left[ q_0 \left( x \right) \vert q_1 \left( x \right) \vert q_2 \left( x \right) \vert \cdots \right]\]</div>
<p>Use the recurrence to compute this Vandermonde matrix.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">vander_legendre</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isnothing</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># Square by default</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span>
<span class="w">        </span><span class="c"># Use the recurrence to compute Q[:,n+1] from Q[:,n] and Q[:,n-1].</span>
<span class="w">        </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">        </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">Q</span>
<span class="k">end</span>

<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">LinRange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span>
<span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vander_legendre</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;</span><span class="se">\$</span><span class="s">P_{</span><span class="si">$j</span><span class="s">}</span><span class="se">\$</span><span class="s">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">5</span><span class="p">)</span><span class="o">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>In both the standard Vandermonde matrix (<code class="docutils literal notranslate"><span class="pre">vander</span></code>) and our Legendre variant, column <span class="math notranslate nohighlight">\(j\)</span> is a polynomial of degree <span class="math notranslate nohighlight">\(j - 1\)</span> evaluated at the points <span class="math notranslate nohighlight">\(x\)</span>. The columns span the same space (i.e., the matrices have the same range). Let’s compare the condition number of these matrices on a set of 50 evenly-spaced points on the interval <span class="math notranslate nohighlight">\(\left[ -1 , \right]\)</span>. Recall that small condition numbers are desirable for numerical stability.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isnothing</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># Square by default</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="n">P</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span>
<span class="w">        </span><span class="n">P</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">P</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">]</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">P</span>
<span class="k">end</span>

<span class="nd">@show</span><span class="w"> </span><span class="n">cond</span><span class="p">(</span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">cond</span><span class="p">(</span><span class="n">vander_legendre</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">));</span>
</pre></div>
</div>
</div>
</section>
<section id="Outlook">
<h2>Outlook<a class="headerlink" href="#Outlook" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>This set of orthogonal polynomials is an alternative basis to polynomials, and much more attractive for approximating functions, due to better conditioning and the convenience of orthogonality (when handling continuous functions).</p></li>
<li><p>The recurrence provides a computationally efficient and numerically stable procedure for evaluating the polynomials of any degree.</p></li>
<li><p>The zeros of these orthogonal polynomials are particularly significant for representing functions and for numerical integration.</p></li>
<li><p>We will compute the zeros efficiently using Newton’s method and a carefully chosen initial guess. (They can also be computed by solving an eigenvalue problem.)</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CSCI 3656</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ungrading.html">Ungrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Class Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quizes.html">Quizes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../homework.html">Homework</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../homework.html">Homework</a><ul>
      <li>Previous: <a href="2025-09-19-Rootfinding-student.html" title="previous chapter">2025-09-19 Rootfinding</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Jeremy L Thompson.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/homework/2025-10-03-Orthogonal-Polynomials-student.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>