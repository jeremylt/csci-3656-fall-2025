<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="2025-10-17 Krylov Subspaces" href="2025-10-17-Krylov-student.html"><link rel="prev" title="2025-09-19 Rootfinding" href="2025-09-19-Rootfinding-student.html">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>2025-10-03 Orthogonal Polynomials</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">CSCI 3656</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">CSCI 3656</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ungrading.html">Ungrading</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notebooks.html">Class Notes</a><input aria-label="Toggle navigation of Class Notes" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-08-22-Welcome.html">2025-08-22 Welcome</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-08-25-Functions.html">2025-08-25 Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-08-27-Function-Error.html">2025-08-27 Function Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-08-29-Conditioning.html">2025-08-29 Conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-03-Rootfinding.html">2025-09-03 Rootfinding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-05-Convergence-Classes.html">2025-09-05 Convergence classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-08-Newton-Methods.html">2025-09-08 Newton Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-10-More-Newton.html">2025-09-10 More Newton</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-12-Formulation.html">2025-09-12 Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-15-Stability.html">2025-09-15 Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-17-Linear-Algebra.html">2025-09-17 Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-19-Geometry.html">2025-09-19 Projections, rotations, and reflections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-22-Gram-Schmidt.html">2025-09-22 Gram-Schmidt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-24-QR-Factorization.html">2025-09-24 QR Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-26-QR-Stability.html">2025-09-26 QR Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-09-29-Householder-QR.html">2025-09-26 Householder QR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-10-01-QR-Retrospective.html">2025-10-01 QR Retrospective</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-10-03-Singular-Value-Decomposition.html">2025-10-03 Singular Value Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/2025-10-06-SVD-Geometry.html">2025-10-06 SVD Geometry</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../quizzes.html">Quizzes</a><input aria-label="Toggle navigation of Quizzes" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../quizes/2025-08-29.html">2025-08-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quizes/2025-09-12.html">2025-09-12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quizes/2025-09-26.html">2025-09-26</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../homework.html">Homework</a><input aria-label="Toggle navigation of Homework" checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2025-09-05-Taylor-Series-student.html">2025-09-05 Taylor Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="2025-09-19-Rootfinding-student.html">2025-09-19 Rootfinding</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">2025-10-03 Orthogonal Polynomials</a></li>
<li class="toctree-l2"><a class="reference internal" href="2025-10-17-Krylov-student.html">2025-10-17 Krylov Subspaces</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/homework/2025-10-03-Orthogonal-Polynomials-student.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <p>Before you turn this problem in, make sure everything runs as expected. First, restart the kernel (in the menubar, select Kernel → Restart) and then run all cells (in the menubar, select Cell → Run All).</p>
<p>Make sure you fill in any place that says <code class="docutils literal notranslate"><span class="pre">BEGIN</span> <span class="pre">SOLUTION</span></code> and <code class="docutils literal notranslate"><span class="pre">END</span> <span class="pre">SOLUTION</span></code>, as well as your name and collaborators below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">COLLABORATORS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</pre></div>
</div>
</div>
<section id="2025-10-03-Orthogonal-Polynomials">
<h1>2025-10-03 Orthogonal Polynomials<a class="headerlink" href="#2025-10-03-Orthogonal-Polynomials" title="Link to this heading">¶</a></h1>
<p>In this activity, we will construct polynomials using orthogonality with respect to an integral inner product. For example, given functions <span class="math notranslate nohighlight">\(u \left( x \right)\)</span> and <span class="math notranslate nohighlight">\(v \left( x \right)\)</span>, we define their inner product to be</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\left\langle u, w \right\rangle = \int_{-1}^{1} u \left( x \right) v \left( x \right) dx\]</div>
</div>
<p>where we use the notation <span class="math notranslate nohighlight">\(\left\langle u, w \right\rangle\)</span> to distinguish this continuous inner product from the discrete inner product <span class="math notranslate nohighlight">\(u^T v\)</span> of vectors.</p>
<p>This is known as the <span class="math notranslate nohighlight">\(L^2\)</span> inner product on the domain <span class="math notranslate nohighlight">\(\left( -1, 1 \right)\)</span>, which is a Hilbert space and a <cite>:math:`L^p</cite> space &lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Lp_space">https://en.wikipedia.org/wiki/Lp_space</a>&gt;`__. The study of such generalizations of linear algebraic concepts is called Functional Analysis, and advanced mathematical topic that is used in numerical activity. We will only need the above definition in this activity.</p>
<p>The inner product induces a norm,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\left\lvert \left\lvert u \right\rvert \right\rvert = \sqrt{\left\langle u, u \right\rangle}\]</div>
</div>
<p>The inner product and norm satisfy the usual properties from our Linear Algebra notebook.</p>
<section id="Working-with-polynomials">
<h2>Working with polynomials<a class="headerlink" href="#Working-with-polynomials" title="Link to this heading">¶</a></h2>
<p>We’ll develop functions to evaluate, multiply, and integrate polynomials expressed as vectors of coefficients.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/latex&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\$</span><span class="s">x^2</span><span class="se">\$</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">Plots</span>
<span class="k">using</span><span class="w"> </span><span class="n">Test</span>

<span class="k">function</span><span class="w"> </span><span class="n">polystring</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Construct a string representation of the polynomial.</span>

<span class="s">    You don&#39;t need to understand this function, it is only</span>
<span class="s">    used to annotate plots and clearly view polynomials.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">join</span><span class="p">((</span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;x^</span><span class="si">$</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$a</span><span class="s"> x^</span><span class="si">$</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="s">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">≠</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="s">&quot; + &quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">polystring</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polydisp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Display the polynomial with friendly math formatting.&quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">join</span><span class="p">((</span><span class="sc">&#39;$&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$name</span><span class="s">(x) = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">polystring</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="sc">&#39;$&#39;</span><span class="p">))</span>
<span class="w">    </span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/latex&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Evaluate function described by coefficients p at point x.</span>

<span class="s">    This uses Horner&#39;s rule, which evaluates a0 + a1 x + a2 x^2 + a3 x^3 as</span>
<span class="s">    a0 + x * (a1 + x * (a2 + x * (a3))).</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="k">end</span><span class="p">]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="w">        </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">.+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">f</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">f</span>
<span class="k">end</span>

<span class="nd">@test</span><span class="w"> </span><span class="n">polyval</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="nb">π</span><span class="p">)</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="nb">π</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="nb">π</span><span class="o">^</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Plot a polynomial p(x) defined by its coefficients</span>
<span class="s">      p[1] + p[2]*x^1 + ... + p[n]*x^(n-1)</span>
<span class="s">    where n = length(p).  We evaluate the polynomial using</span>
<span class="s">    our polyval.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isnothing</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="w">        </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polystring</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">plot!</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">join</span><span class="p">((</span><span class="sc">&#39;$&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;$&#39;</span><span class="p">)))</span>
<span class="k">end</span>

<span class="n">plot</span><span class="p">()</span>
<span class="n">polyplot</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The polynomial manipulation functions such as <code class="docutils literal notranslate"><span class="pre">polyint</span></code> are <span class="math notranslate nohighlight">\(\mathcal{O} \left( n \right)\)</span> (linear time) operations on lists or arrays. We’ll start by implementing <code class="docutils literal notranslate"><span class="pre">polyint</span></code>, which computes the indefinite integral</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P \left( x \right) = \int p \left( x \right) dx\]</div>
</div>
<p>i.e., <span class="math notranslate nohighlight">\(P' \left( x \right) = p \left( x \right)\)</span>. Note that the antiderivative <span class="math notranslate nohighlight">\(P \left( x \right)\)</span> is a polynomial determined only up to an integration constant, which you man choose arbitrarily.</p>
<p>As an example,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\int 1 + 4 x + 6 x^3 = C + x + 2x^2 + \frac{6}{4} x^4\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> can be any value, so we should have</p>
<p><code class="docutils literal notranslate"><span class="pre">polyint([1</span> <span class="pre">4</span> <span class="pre">0</span> <span class="pre">6])</span> <span class="pre">==</span> <span class="pre">[0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">0</span> <span class="pre">6/4]</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyint</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Without using library functions, compute an indefinite integral</span>
<span class="s">    of p(x) expressed as a polynomial of degree 1 higher than the</span>
<span class="s">    degree of p.  The constant of integration may be chosen arbitrarily.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span><span class="w"> </span><span class="c"># Convert from row or column vector into list</span>
<span class="w">    </span><span class="n">pint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c"># Array to hold the indefinite integral</span>
<span class="w">    </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">    </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="c"># return a row vector (for easier viewing)</span>
<span class="w">    </span><span class="n">reshape</span><span class="p">(</span><span class="n">pint</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span>
<span class="n">polydisp</span><span class="p">(</span><span class="sc">&#39;p&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polyint</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">polydisp</span><span class="p">(</span><span class="sc">&#39;P&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span><span class="w"> </span><span class="n">polyint</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mf">.5</span><span class="p">]</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">polyint</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">polyint</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="Multiplying-polynomials">
<h2>Multiplying polynomials<a class="headerlink" href="#Multiplying-polynomials" title="Link to this heading">¶</a></h2>
<p>We need to be able to compute the product of polynomials. For example,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\left( a_1 + a_2 x + a_3 x^2 \right) \left( b_1 + b_2 x + b_3 x^2 \right) = a_1 b_1 + \left( a_1 b_2 + a_2 b_1 \right) x + \left( a_1 b_3 + a_2 b_2 + a_3 b_1 \right) x^2 + \left( a_2 b_3 + a_3 b_2 \right) x^3 + a_3 b_3 x^4\]</div>
</div>
<p>(You may notice that one-based indexing is kinda awkward here compared to zero-based indexing.)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polymul</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Multiply two polynomials, returning a polynomial.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="w">            </span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="c"># return a row vector (for easier viewing)</span>
<span class="w">    </span><span class="n">reshape</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polymul</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">])</span>
<span class="n">polydisp</span><span class="p">(</span><span class="sc">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">()</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">.5</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="n">polyplot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">polyplot</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">polyplot</span><span class="p">(</span><span class="n">polymul</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">))</span>
<span class="n">plot!</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="ss">:black</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Addition-and-subtraction">
<h2>Addition and subtraction<a class="headerlink" href="#Addition-and-subtraction" title="Link to this heading">¶</a></h2>
<p>We need to be able to add and subtract polynomials, that is, to compute <span class="math notranslate nohighlight">\(r = p + q\)</span> and <span class="math notranslate nohighlight">\(r = p - q\)</span>. This is just entry-wise addition and subtraction, except that the vectors may have different lengths.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyadd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">q</span>
<span class="w">    </span><span class="n">reshape</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">polyadd</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polysub</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">q</span>
<span class="w">    </span><span class="n">reshape</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">polysub</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="Inner-products-of-polynomials">
<h2>Inner products of polynomials<a class="headerlink" href="#Inner-products-of-polynomials" title="Link to this heading">¶</a></h2>
<p>We will use the <span class="math notranslate nohighlight">\(L^2\)</span> inner product,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\left\langle u, v \right\rangle = \int_{-1}^{1} u \left( x \right) v \left( x \right) dx\]</div>
</div>
<p>restricted to the case where <span class="math notranslate nohighlight">\(u \left( x \right)\)</span> and $ v <span class="math">\left`( x :nbsphinx-math:</span>right`)$ are polynomials.</p>
<p>Recall the <a class="reference external" href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_calculus">Fundamental Theorem of Calculus</a>, which says that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\int_a^b f \left( x \right) = F \left( b \right) - F \left( a \right)\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is a function such that <span class="math notranslate nohighlight">\(F' \left( x \right) = f \left( x \right)\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Use polymul, polyint, and polyval to define the L2</span>
<span class="s">    inner product of u and v on the interval (-1, 1). Both u and v</span>
<span class="s">    are polynomials expressed as arrays in the usual way. Recall that</span>
<span class="s">    the inner product returns a scalar (single number).</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">    </span><span class="c">### SOLUTION END</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">display_inner_product</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">    </span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/html&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\$</span><span class="s"> </span><span class="se">\\</span><span class="s">langle </span><span class="si">$</span><span class="p">(</span><span class="n">polystring</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="s">, </span><span class="si">$</span><span class="p">(</span><span class="n">polystring</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="s"> </span><span class="se">\\</span><span class="s">rangle = </span><span class="si">$</span><span class="p">(</span><span class="n">poly_inner_product</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">))</span><span class="s"> </span><span class="se">\$</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">poly_inner_product</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span>
<span class="n">display_inner_product</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span>
<span class="n">display_inner_product</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mi">0</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mi">0</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mi">0</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mf">11.2</span>
</pre></div>
</div>
</div>
</section>
<section id="Norms-of-polynomials">
<h2>Norms of polynomials<a class="headerlink" href="#Norms-of-polynomials" title="Link to this heading">¶</a></h2>
<p>Recall that an inner product <strong>induces</strong> a norm. We’ll define it now and use it later to normalize polynomials.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute the norm of the polynomial p(x) induced by poly_inner_product().</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">    </span><span class="c">### SOLUTION END</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Orthogonalization-of-polynomials">
<h2>Orthogonalization of polynomials<a class="headerlink" href="#Orthogonalization-of-polynomials" title="Link to this heading">¶</a></h2>
<p>We now have the ingredients to use the Gram-Schmidt algorithm to orgthogonalize polynomials (starting with the monomials) with respect to the <span class="math notranslate nohighlight">\(L^2\)</span> inner product. We start by defining a “matrix” in which each of the columns is a polynomial. This is conceptually similar to a Vandermonde matrix (see <code class="docutils literal notranslate"><span class="pre">np.vander()</span></code>) in the limit where we evaluate at infinitely many points; instead of storing infinitely tall columns, we store each as a list defining the polynomial.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Return a list of the first n monomials in order of increasing degree.</span>
<span class="s">    We will think of this as a &quot;tall&quot; matrix indexed by its n columns.</span>
<span class="s">    Each column contains a polynomial.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">        </span><span class="n">p</span><span class="p">[</span><span class="k">end</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">push!</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">A</span>
<span class="k">end</span>

<span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Columns of the monomial matrix&quot;</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="w">    </span><span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;p_</span><span class="si">$j</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">plot!</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Projections">
<h2>Projections<a class="headerlink" href="#Projections" title="Link to this heading">¶</a></h2>
<p>Polynomials can be projected just like vectors. For example, if <span class="math notranslate nohighlight">\(q \left( x \right)\)</span> is normalized,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[q \left\langle q, p \right\rangle\]</div>
</div>
<p>is the orthogonal projection of <span class="math notranslate nohighlight">\(p\)</span> into the subspace of <span class="math notranslate nohighlight">\(q\)</span> and</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p - q \left\langle q, p \right\rangle\]</div>
</div>
<p>is the part orthogonal to <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>Notice the similarities between the expressions above (involving the <span class="math notranslate nohighlight">\(L^2\)</span> inner product) and those for projections of finite-dimensional vectors, <span class="math notranslate nohighlight">\(q q^T p\)</span> and <span class="math notranslate nohighlight">\(\left( I - q q^T \right) p\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_project_orthog</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Find the component of p(x) that is orthogonal to the normalized</span>
<span class="s">    polynomial q(x).</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="c"># length of p in direction q</span>
<span class="w">    </span><span class="c"># polysub is just subtraction of arrays, but lines them up correctly</span>
<span class="w">    </span><span class="c"># in case they are different lengths</span>
<span class="w">    </span><span class="n">polysub</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="c"># p - q c</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">test_project</span><span class="p">()</span>
<span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w">    </span><span class="n">plot</span><span class="p">()</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w">                      </span><span class="c"># x</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w">                      </span><span class="c"># x^3</span>
<span class="w">    </span><span class="n">display_inner_product</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="w">    </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w">         </span><span class="c"># Normalize x in L^2 norm</span>
<span class="w">    </span><span class="n">display</span><span class="p">(</span><span class="s">&quot;text/latex&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\$</span><span class="s"> </span><span class="se">\\</span><span class="s">lVert p_1 </span><span class="se">\\</span><span class="s">rVert = </span><span class="si">$</span><span class="p">(</span><span class="n">poly_norm</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span><span class="s"> </span><span class="se">\$</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="w">    </span><span class="n">p3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_project_orthog</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">p1</span><span class="p">)</span><span class="w">  </span><span class="c"># Find component of x^3 that is orthogonal to x</span>
<span class="w">    </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>
<span class="w">    </span><span class="n">display_inner_product</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">p3</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">test_project</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Polynomial-matrix-multiplication">
<h2>Polynomial matrix multiplication<a class="headerlink" href="#Polynomial-matrix-multiplication" title="Link to this heading">¶</a></h2>
<p>We have discussed the matrix product <span class="math notranslate nohighlight">\(A x\)</span> being a linear combination of the columns of <span class="math notranslate nohighlight">\(A\)</span>. If <span class="math notranslate nohighlight">\(A\)</span> is a polynomial matrix with <span class="math notranslate nohighlight">\(m\)</span> columns (we’ll say it has shape <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">m)</span></code>), then</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A x = \sum_i A_{:, i} x_i\]</div>
</div>
<p>Similarly, if <span class="math notranslate nohighlight">\(B\)</span> is a <span class="math notranslate nohighlight">\(m \times n\)</span> matrix (i.e. shape <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n)</span></code>), then the <span class="math notranslate nohighlight">\(j\)</span>th column of <span class="math notranslate nohighlight">\(C = A B\)</span> is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C_{:, j} = \sum_k A_{:, k} B_{k, j}\]</div>
</div>
<p>The matrix <span class="math notranslate nohighlight">\(C\)</span> is also a polynomial matrix, now with shape <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n)</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Multiply a polynomial matrix A of shape (*,m) times</span>
<span class="s">    a matrix B of shape (m,n) to yield a polynomial matrix</span>
<span class="s">    C of shape (*,n).</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="c"># Use polyadd to compute A * B[:,j] and</span>
<span class="w">        </span><span class="c"># append it to C using push!(C, new_col)</span>
<span class="w">        </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">        </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">C</span>
<span class="k">end</span>

<span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span>

<span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;C_{:,1}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;C_{:,2}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;C_{:,3}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">  </span><span class="c"># The polynomial 1</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w">  </span><span class="c"># The polynomial x</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w"> </span><span class="c"># The polynomial x^2</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">&#39;</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="n">Cref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">7</span><span class="p">]]</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">Cref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">Cref</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="QR-factorization-of-monomials">
<h2>QR factorization of monomials<a class="headerlink" href="#QR-factorization-of-monomials" title="Link to this heading">¶</a></h2>
<p>We can apply the Gram-Schmidt process to compute a QR factorization of the monomials. This will yield an orthogonal basis of polynomials.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute a reduced QR factorization of the polynomials in the columns of A</span>
<span class="s">    using the Gram-Schmidt algorithm. If A has shape (*,n), the factor Q will have</span>
<span class="s">    shape (*,n) (i.e., a list of polynomials) and R will be a square (n,n)</span>
<span class="s">    triangular matrix.</span>

<span class="s">    This algorithm can look line-for-line like the naive Gram-Schmidt in our class</span>
<span class="s">    notebook (see Feb 11 or Feb 16 lectures), but you&#39;ll need to use the appropriate</span>
<span class="s">    functions that act on polynomials, an ensure you are accessing columns. That is,</span>
<span class="s">    when working with polynomial matrices (shape (*,n)), column j is accessed as A[j]</span>
<span class="s">    instead of A[:,j] for traditional matrices.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="w"> </span><span class="c"># Each column of A and R</span>
<span class="w">        </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">        </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span>
<span class="k">end</span>

<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="w">    </span><span class="n">polydisp</span><span class="p">(</span><span class="s">&quot;q_{</span><span class="si">$j</span><span class="s">}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">## This cell explores some properties of the factorization, and its output</span>
<span class="c">## may be helpful in debugging your implementation above.</span>

<span class="k">function</span><span class="w"> </span><span class="n">poly_QtQ</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute Q.T Q where Q is a matrix of polynomials</span>
<span class="s">    expressed as a list of columns. The result is an ordinary</span>
<span class="s">    square matrix.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">            </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_inner_product</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">A</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">poly_matsub</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute A - B where A and B are matrices of polynomials</span>
<span class="s">    expressed as lists of columns.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">        </span><span class="n">push!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">polysub</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">C</span>
<span class="k">end</span>

<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">QtQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_QtQ</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">QtQ</span>
<span class="n">QR_minus_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_matsub</span><span class="p">(</span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">QR_minus_A</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QtQ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QR_minus_A</span><span class="p">)</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QtQ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e-12</span>
<span class="nd">@test</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QR_minus_A</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e-12</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># The Q factor loses orthogonality as the maximum degree is increased.</span>
<span class="c"># This is much the same effect as we&#39;ve observed with Vandermonde matrices</span>
<span class="c"># in class, and part of the motivation for the Householder algorithm.</span>

<span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monomials</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">QtQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_QtQ</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="n">QR_minus_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_matsub</span><span class="p">(</span><span class="n">poly_matmul</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="n">A</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QtQ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">)</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">QR_minus_A</span><span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="Plot-the-orthogonal-polynomials">
<h2>Plot the orthogonal polynomials<a class="headerlink" href="#Plot-the-orthogonal-polynomials" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_plotmat</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot</span><span class="p">()</span><span class="w"> </span><span class="c"># Create new figure</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">        </span><span class="n">polyplot</span><span class="p">(</span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;p_{</span><span class="si">$j</span><span class="s">}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">handle</span>
<span class="k">end</span>

<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">poly_plotmat</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Normalization">
<h2>Normalization<a class="headerlink" href="#Normalization" title="Link to this heading">¶</a></h2>
<p>Our QR factorization is normalized using the <span class="math notranslate nohighlight">\(L^2\)</span> norm, which is just fine mathematically, but perhaps not visually satisfying.</p>
<p>This set of polynomials is famous (<a class="reference external" href="https://en.wikipedia.org/wiki/Legendre_polynomials">Legendre polynomials</a>), but with the normalization <span class="math notranslate nohighlight">\(p \left( 1 \right) = 1\)</span> instead of the <span class="math notranslate nohighlight">\(L^2\)</span> normalization <span class="math notranslate nohighlight">\(\left\langle p \left( x \right), p \left( x \right) \right\rangle = 1\)</span>. Let’s convert our <span class="math notranslate nohighlight">\(QR\)</span> factorization to use this different normalization convention.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">poly_qr_norm1</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;Compute a QR factorization with the normalization convention that</span>
<span class="s">    q(1) = 1 for each column of Q.  This can be constructed by modifying</span>
<span class="s">    the standard QR factorization (scaling the columns of Q and absorbing</span>
<span class="s">    that scaling factor into R).</span>

<span class="s">    The resulting matrix Q should have columns that are orthogonal with</span>
<span class="s">    respect to the L^2 inner product, but they will not be normalized with</span>
<span class="s">    respect to that product.  Consequently, Q^T Q will be diagonal, but</span>
<span class="s">    not the identity.</span>

<span class="s">    The factors should still satisfy Q R = A.</span>
<span class="s">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="w">    </span><span class="c"># Loop over columns of Q (and rows of R).</span>
<span class="w">    </span><span class="c"># Use polyval() to evaluate each column at x=1 and use that</span>
<span class="w">    </span><span class="c"># normalization to scale the column of Q and corresponding entries</span>
<span class="w">    </span><span class="c"># of R. The new columns of Q should be orthogonal, but will not, in</span>
<span class="w">    </span><span class="c"># general, have norm 1.  This means Q^T Q will be diagonal, but not</span>
<span class="w">    </span><span class="c"># the identity.  Q R = A should still be satisfied.</span>
<span class="w">    </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">    </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span>
<span class="k">end</span>

<span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr_norm1</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">poly_plotmat</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_qr_norm1</span><span class="p">(</span><span class="n">monomials</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">diag</span><span class="p">(</span><span class="n">poly_QtQ</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># There is an analytic formula for this normalizing factor</span>
<span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">5</span><span class="p">]</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
</section>
<section id="Recurrence-relation">
<h2>Recurrence relation<a class="headerlink" href="#Recurrence-relation" title="Link to this heading">¶</a></h2>
<p>Although there is also structure in the factor <span class="math notranslate nohighlight">\(R\)</span>, we are often interested only in the basis <span class="math notranslate nohighlight">\(Q\)</span>. Let us test whether our functions, the columns of <span class="math notranslate nohighlight">\(Q\)</span> (with our new normalization convention), satisfy the recurrence relation</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\left( n + 1 \right) q_{n + 1} \left( x \right) = \left( 2 n + 1 \right) x q_n \left( x \right) - n q_{n - 1} \left( x \right)\]</div>
</div>
<p>The above uses the standard convention that <span class="math notranslate nohighlight">\(q_n\)</span> is a polynomial of degree <span class="math notranslate nohighlight">\(n\)</span>, but we’re using Julia’s 1-based indexing so our <span class="math notranslate nohighlight">\(q_n\)</span> is a polynomial of degree <span class="math notranslate nohighlight">\(n - 1\)</span>. As such, we’ll rewrite the standard recurrence as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\left( n + 1 \right) q_{n + 2} \left( x \right) = \left( 2 n + 1 \right) x q_{n + 1} \left( x \right) - n q_n \left( x \right)\]</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>
<span class="w">    </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">polymul</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">Q</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="w">    </span><span class="n">rhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polysub</span><span class="p">(</span><span class="n">term</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
<span class="w">    </span><span class="n">lhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
<span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly_norm</span><span class="p">(</span><span class="n">polysub</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="p">))</span>
<span class="w">    </span><span class="nd">@show</span><span class="w"> </span><span class="n">err</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<p>This recurrence is faster and more stable to evaluate than applying Gram-Schmidt to the monomials. We can use it to create a generalized Vandermonde matrix in which the columns are Legendre polynomials instead of the monomials. This matrix will look like</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Q = \left[ q_0 \left( x \right) \vert q_1 \left( x \right) \vert q_2 \left( x \right) \vert \cdots \right]\]</div>
</div>
<p>Use the recurrence to compute this Vandermonde matrix.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">vander_legendre</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isnothing</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># Square by default</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span>
<span class="w">        </span><span class="c"># Use the recurrence to compute Q[:,n+1] from Q[:,n] and Q[:,n-1].</span>
<span class="w">        </span><span class="c">### SOLUTION BEGIN</span>

<span class="w">        </span><span class="c">### SOLUTION END</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">Q</span>
<span class="k">end</span>

<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">LinRange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span>
<span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vander_legendre</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;</span><span class="se">\$</span><span class="s">P_{</span><span class="si">$j</span><span class="s">}</span><span class="se">\$</span><span class="s">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">5</span><span class="p">)</span><span class="o">&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>In both the standard Vandermonde matrix (<code class="docutils literal notranslate"><span class="pre">vander</span></code>) and our Legendre variant, column <span class="math notranslate nohighlight">\(j\)</span> is a polynomial of degree <span class="math notranslate nohighlight">\(j - 1\)</span> evaluated at the points <span class="math notranslate nohighlight">\(x\)</span>. The columns span the same space (i.e., the matrices have the same range). Let’s compare the condition number of these matrices on a set of 50 evenly-spaced points on the interval <span class="math notranslate nohighlight">\(\left[ -1 , \right]\)</span>. Recall that small condition numbers are desirable for numerical stability.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isnothing</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># Square by default</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="n">P</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span>
<span class="w">        </span><span class="n">P</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">P</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">]</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">P</span>
<span class="k">end</span>

<span class="nd">@show</span><span class="w"> </span><span class="n">cond</span><span class="p">(</span><span class="n">vander</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span>
<span class="nd">@show</span><span class="w"> </span><span class="n">cond</span><span class="p">(</span><span class="n">vander_legendre</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">));</span>
</pre></div>
</div>
</div>
</section>
<section id="Outlook">
<h2>Outlook<a class="headerlink" href="#Outlook" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>This set of orthogonal polynomials is an alternative basis to polynomials, and much more attractive for approximating functions, due to better conditioning and the convenience of orthogonality (when handling continuous functions).</p></li>
<li><p>The recurrence provides a computationally efficient and numerically stable procedure for evaluating the polynomials of any degree.</p></li>
<li><p>The zeros of these orthogonal polynomials are particularly significant for representing functions and for numerical integration.</p></li>
<li><p>We will compute the zeros efficiently using Newton’s method and a carefully chosen initial guess. (They can also be computed by solving an eigenvalue problem.)</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="2025-10-17-Krylov-student.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">2025-10-17 Krylov Subspaces</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="2025-09-19-Rootfinding-student.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">2025-09-19 Rootfinding</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Jeremy L Thompson
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">2025-10-03 Orthogonal Polynomials</a><ul>
<li><a class="reference internal" href="#Working-with-polynomials">Working with polynomials</a></li>
<li><a class="reference internal" href="#Multiplying-polynomials">Multiplying polynomials</a></li>
<li><a class="reference internal" href="#Addition-and-subtraction">Addition and subtraction</a></li>
<li><a class="reference internal" href="#Inner-products-of-polynomials">Inner products of polynomials</a></li>
<li><a class="reference internal" href="#Norms-of-polynomials">Norms of polynomials</a></li>
<li><a class="reference internal" href="#Orthogonalization-of-polynomials">Orthogonalization of polynomials</a></li>
<li><a class="reference internal" href="#Projections">Projections</a></li>
<li><a class="reference internal" href="#Polynomial-matrix-multiplication">Polynomial matrix multiplication</a></li>
<li><a class="reference internal" href="#QR-factorization-of-monomials">QR factorization of monomials</a></li>
<li><a class="reference internal" href="#Plot-the-orthogonal-polynomials">Plot the orthogonal polynomials</a></li>
<li><a class="reference internal" href="#Normalization">Normalization</a></li>
<li><a class="reference internal" href="#Recurrence-relation">Recurrence relation</a></li>
<li><a class="reference internal" href="#Outlook">Outlook</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>